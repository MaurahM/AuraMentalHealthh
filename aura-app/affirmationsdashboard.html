
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Affirmations </title>
<style>
  :root{
    /* Softer, more cohesive colors */
    --bg: #291124; /* Darker, calmer background */
    --panel: #3a1c31; /* Subtle contrast for the main panel */
    --card: #5a284c; /* Unused in this version, but good to keep */
    --tile-start: #d973f0; /* Pinkish-Purple */
    --tile-end: #ff2fa6; /* Bright Magenta */
    --accent: #ff2fa6;
    --muted: #e0e0e0; /* Slightly brighter for better contrast */
    --white: #ffffff;
    --shadow: rgba(0,0,0,0.55);
  }
  html,body{
    height:100%;
    margin:0;
    font-family:'Segoe UI',Roboto,"Helvetica Neue",Arial,sans-serif; /* A more common, readable font stack */
    background:var(--bg);
    color:var(--white);
    line-height:1.5;
  }
  .wrap{
    min-height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:32px 16px;
    box-sizing:border-box;
  }
  .panel{
    width:100%;
    max-width:900px;
    background:var(--panel);
    border-radius:16px;
    padding:32px;
    box-shadow:0 15px 40px var(--shadow);
    box-sizing:border-box;
    border:1px solid rgba(255,255,255,0.05); /* Subtle border for depth */
  }
  .header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:28px;
    padding-bottom:10px;
    border-bottom:1px solid rgba(255,255,255,0.08);
  }
  .title{
    font-weight:600;
    font-size:26px; /* Larger title */
    color:var(--white);
  }
  .sub{
    color:var(--muted);
    font-size:15px;
  }
  .grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); /* Better responsiveness */
    gap:20px;
    margin:30px auto 0;
  }
  .tile{
    background:linear-gradient(135deg, var(--tile-start), var(--tile-end)); /* Vibrant gradient */
    color:var(--white);
    padding:40px 20px;
    border:0;
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:700;
    font-size:18px;
    cursor:pointer;
    box-shadow:0 6px 18px rgba(0,0,0,0.25);
    transition:transform .15s ease,box-shadow .15s ease,opacity .15s ease;
    text-align:center;
    outline:none;
  }
  .tile:focus,.tile:hover{
    transform:translateY(-4px); /* Softer lift */
    box-shadow:0 12px 30px rgba(0,0,0,0.4);
    opacity:0.95;
  }
  .tile:focus-visible { /* Better focus visibility */
    outline: 2px solid var(--muted);
    outline-offset: 4px;
  }
  .note{
    color:var(--muted);
    text-align:center;
    margin-top:25px;
    font-size:14px;
    opacity:0.8;
  }
  .back{
    background:rgba(255,255,255,0.06);
    border:1px solid rgba(255,255,255,0.1);
    color:var(--muted);
    padding:10px 18px;
    border-radius:10px;
    text-decoration:none;
    font-size:14px;
    transition:background .15s ease;
  }
  .back:hover{
    background:rgba(255,255,255,0.12);
  }
  /* modal */
  .backdrop{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.7); /* Darker backdrop */
    display:none;
    align-items:center;
    justify-content:center;
    z-index:1000; /* High z-index */
  }
  .modal{
    background:#200e1b; /* Even darker, highly contrasting background */
    padding:24px;
    border-radius:16px;
    max-width:600px; /* Slightly narrower modal */
    width:90%;
    box-shadow:0 40px 100px rgba(0,0,0,0.8);
    color:var(--white);
    max-height:80vh;
    overflow-y:auto;
    border:1px solid var(--accent); /* Accent border */
  }
  .modal h2{
    margin:0 0 10px;
    font-size:22px;
    font-weight:600;
  }
  .list{
    display:grid;
    gap:15px;
  }
  .affirm{
    background:rgba(255,255,255,0.05);
    padding:15px;
    border-radius:12px;
    color:var(--muted);
    display:flex;
    justify-content:space-between;
    align-items:center;
    cursor:pointer;
    transition:background .15s ease;
    border:1px solid transparent;
  }
  .affirm:hover{
    background:rgba(255,255,255,0.1);
    border-color:var(--accent); /* Highlight on hover */
  }
  .affirm .text{
    max-width:80%;
    font-size:16px;
    line-height:1.4;
    font-style:italic; /* Subtle stylistic change */
  }
  .affirm button{
    background:var(--accent); /* Solid accent color */
    border:0;
    color:#fff;
    padding:8px 14px;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
    transition:opacity .1s ease;
  }
  .affirm button:hover{
    opacity:0.9;
  }
  .close{
    background:transparent;
    border:1px solid rgba(255,255,255,0.15);
    color:var(--muted);
    cursor:pointer;
    font-size:14px;
    padding:6px 10px;
    border-radius:8px;
    transition:border-color .15s ease, color .15s ease;
  }
  .close:hover{
    border-color:var(--white);
    color:var(--white);
  }
  @media (max-width:768px){ 
    .panel{padding:24px;border-radius:12px;}
    .grid{grid-template-columns:repeat(2,1fr)}
    .tile{padding:30px 15px;font-size:17px}
  }
  @media (max-width:500px){
    .wrap{padding:16px;}
    .grid{grid-template-columns:1fr; gap:16px;}
    .tile{padding:25px;font-size:16px}
    .header{flex-direction:column;align-items:flex-start;margin-bottom:20px;}
    .title{font-size:24px;}
    .back{margin-top:10px;align-self:flex-end;}
  }
</style>
<script src="theme-manager.js"></script>
</head>
<body>
    <script>
    // --- ðŸ”‘ AUTHENTICATION GUARD SCRIPT (MUST RUN FIRST) ---
    const TOKEN_KEY = 'convai_user_token';
    const token = localStorage.getItem(TOKEN_KEY);

    // If the token is missing (meaning the user logged out), redirect immediately.
    if (!token) {
        window.location.href = 'index.html';
    }
    // --- END GUARD SCRIPT ---
</script>
  <main class="wrap" role="main" aria-labelledby="affTitle">
    <section class="panel" aria-labelledby="affTitle">
      <div class="header">
        <div>
          <div id="affTitle" class="title">Affirmations</div>
          <div class="sub">Select a category to view short, supportive affirmations you can copy or read aloud.</div>
        </div>
        <div><a href="Dashboard.html" class="back">Back</a></div>
      </div>

      <div class="grid" role="list" id="categories">
        <!-- tiles inserted by JS -->
      </div>

      <div class="note">Tip: click an affirmation to copy it to your clipboard.</div>
    </section>
  </main>

  <div id="backdrop" class="backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="modalTitle">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <h2 id="modalTitle">Category</h2>
        <div>
          <button id="closeModal" class="close" aria-label="Close">Close</button>
        </div>
      </div>
      <div id="affirmList" class="list" role="list">
        <!-- affirmations injected here -->
      </div>
    </div>
  </div>

<script>
  const categories = {
    Gratitude: [
      "I am grateful for the good in my life.",
      "I notice and appreciate small blessings today.",
      "Thank you for the people who support me."
    ],
    Calm: [
      "I breathe in peace and exhale tension.",
      "I am grounded and present in this moment.",
      "I allow calm to wash over me."
    ],
    Growth: [
      "I learn and grow from every experience.",
      "I am patient with my progress.",
      "Challenges help me become stronger."
    ],
    Abundance: [
      "I am open to receiving abundance in many forms.",
      "There is enough for me and for others.",
      "Opportunities flow to me easily."
    ],
    Resilience: [
      "I recover from setbacks with grace.",
      "I trust my ability to handle difficult times.",
      "Each day I become more resilient."
    ],
    Hope: [
      "I hold space for hope and possibility.",
      "Tomorrow brings new opportunities.",
      "I believe in my capacity to heal and change."
    ]
  };

  const categoriesEl = document.getElementById('categories');
  const backdrop = document.getElementById('backdrop');
  const modalTitle = document.getElementById('modalTitle');
  const affirmList = document.getElementById('affirmList');
  const closeModal = document.getElementById('closeModal');

  function buildTiles() {
    Object.keys(categories).forEach(key => {
      const btn = document.createElement('button');
      btn.className = 'tile';
      btn.setAttribute('role','button');
      btn.tabIndex = 0;
      btn.innerText = key;
      btn.dataset.category = key;
      btn.addEventListener('click', () => openCategory(key));
      btn.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openCategory(key); }});
      categoriesEl.appendChild(btn);
    });
  }

  function openCategory(name) {
    modalTitle.textContent = name;
    affirmList.innerHTML = '';
    categories[name].forEach((txt, i) => {
      const el = document.createElement('div');
      el.className = 'affirm';
      el.innerHTML = `<div class="text">${escapeHtml(txt)}</div><div><button data-t="${i}">Copy</button></div>`;
      el.querySelector('button').addEventListener('click', () => {
        copyToClipboard(txt);
        el.querySelector('button').textContent = 'Copied';
        setTimeout(() => el.querySelector('button').textContent = 'Copy', 1200);
      });
      // also allow clicking the affirmation to copy
      el.addEventListener('click', (e) => {
        if (e.target.tagName.toLowerCase() !== 'button') {
          copyToClipboard(txt);
          const btn = el.querySelector('button');
          btn.textContent = 'Copied';
          setTimeout(() => btn.textContent = 'Copy', 1200);
        }
      });
      affirmList.appendChild(el);
    });
    backdrop.style.display = 'flex';
    backdrop.setAttribute('aria-hidden','false');
    closeModal.focus();
  }

  function close() {
    backdrop.style.display = 'none';
    backdrop.setAttribute('aria-hidden','true');
  }

  closeModal.addEventListener('click', close);
  backdrop.addEventListener('click', (e) => { if (e.target === backdrop) close(); });
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && backdrop.style.display === 'flex') close(); });

  function copyToClipboard(text) {
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(text).catch(()=>fallbackCopy(text));
    } else fallbackCopy(text);
  }
  function fallbackCopy(t) {
    const ta = document.createElement('textarea');
    ta.value = t; ta.style.position='fixed'; ta.style.left='-9999px';
    document.body.appendChild(ta); ta.select();
    try { document.execCommand('copy'); } catch(e) {}
    document.body.removeChild(ta);
  }

  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

  buildTiles();
</script>
</body>
</html>
